---
# Kubernetes Bootstrap - Common Configuration
# =============================================================================
# This file contains settings shared across ALL cluster deployments.
# Cluster-specific settings are in separate files (mgmt_core.yml, etc.)
#
# Select cluster type by using the appropriate inventory file:
#   ansible-playbook -i inventory/mgmt-core.ini bootstrap-k8s.yml
#   ansible-playbook -i inventory/mgmt-devops.ini bootstrap-k8s.yml
#   ansible-playbook -i inventory/mgmt-observability.ini bootstrap-k8s.yml

# =============================================================================
# KUBERNETES VERSION
# =============================================================================
# Check releases: https://kubernetes.io/releases/
k8s_version: "1.31"
k8s_full_version: "1.31.4"

# =============================================================================
# CONTAINER RUNTIME
# =============================================================================
container_runtime: "containerd"
containerd_version: "1.7.24"
cni_plugins_version: "1.6.0"
runc_version: "1.2.3"

# =============================================================================
# CNI (NETWORK PLUGIN)
# =============================================================================
# Options: flannel, calico
cni_plugin: "flannel"
flannel_version: "0.26.1"
calico_version: "3.29.1"

# =============================================================================
# NODE CONFIGURATION
# =============================================================================
disable_swap: true

kernel_modules:
  - overlay
  - br_netfilter

sysctl_settings:
  net.bridge.bridge-nf-call-iptables: 1
  net.bridge.bridge-nf-call-ip6tables: 1
  net.ipv4.ip_forward: 1

# =============================================================================
# FIREWALL PORTS
# =============================================================================
control_plane_ports:
  - 6443/tcp    # Kubernetes API server
  - 2379/tcp    # etcd client
  - 2380/tcp    # etcd peer
  - 10250/tcp   # Kubelet API
  - 10259/tcp   # kube-scheduler
  - 10257/tcp   # kube-controller-manager

worker_ports:
  - 10250/tcp   # Kubelet API
  - 10256/tcp   # kube-proxy
  - 30000-32767/tcp  # NodePort Services

flannel_ports:
  - 8472/udp    # VXLAN

# =============================================================================
# ADDITIONAL COMPONENTS
# =============================================================================
install_bash_completion: true
install_helm: true
helm_version: "3.16.3"
install_metrics_server: true

# =============================================================================
# CLUSTER DEFAULTS (can be overridden in cluster-specific vars)
# =============================================================================
cluster_domain: "cluster.local"
token_ttl: "24h"

# =============================================================================
# DOMAIN SETTINGS
# =============================================================================
dns_domain: "engatwork.com"
